# Read COLVAR file
# RemoVe BANDWIDTHS and substitute with KERNEL=DISCRETE in case one wants DISCRETE kernel.

tic0:   READ FILE=COLVAR-meta-trp  IGNORE_TIME VALUES=tic0
tic1:   READ FILE=COLVAR-meta-trp  IGNORE_TIME VALUES=tic1
tic2:   READ FILE=COLVAR-meta-trp  IGNORE_TIME VALUES=tic2
tic3:   READ FILE=COLVAR-meta-trp  IGNORE_TIME VALUES=tic3
tic4:   READ FILE=COLVAR-meta-trp  IGNORE_TIME VALUES=tic4

chi1:   READ FILE=COLVAR-meta-trp  IGNORE_TIME VALUES=chi1_78
chi2:   READ FILE=COLVAR-meta-trp  IGNORE_TIME VALUES=chi2_78
d1:     READ FILE=COLVAR-meta-trp  IGNORE_TIME VALUES=d1
d3:     READ FILE=COLVAR-meta-trp  IGNORE_TIME VALUES=d3
d4:     READ FILE=COLVAR-meta-trp  IGNORE_TIME VALUES=d4

t3:     READ FILE=COLVAR-meta-trp  IGNORE_TIME VALUES=t3
t4:     READ FILE=COLVAR-meta-trp  IGNORE_TIME VALUES=t4

metad:       READ FILE=COLVAR-meta-trp IGNORE_TIME VALUES=metad.rbias
#uwall:       READ FILE=COLVAR IGNORE_TIME VALUES=uwall.bias
#lwall:       READ FILE=COLVAR IGNORE_TIME VALUES=lwall.bias
#tuwall:       READ FILE=COLVAR IGNORE_TIME VALUES=tuwall.bias
#tlwall:       READ FILE=COLVAR IGNORE_TIME VALUES=tlwall.bias

# Define weights
weights1: REWEIGHT_METAD TEMP=300 ARG=metad.rbias

# Calculate histograms

HISTOGRAM ...

  ARG=tic0
  GRID_MIN=-3.5
  GRID_MAX=2
  GRID_BIN=200
  BANDWIDTH=0.03
  LOGWEIGHTS=weights1
  LABEL=hh1

... HISTOGRAM

HISTOGRAM ...

  ARG=tic1
  GRID_MIN=-2.5
  GRID_MAX=3.0
  GRID_BIN=200
  BANDWIDTH=0.03
  LOGWEIGHTS=weights1
  LABEL=hh2

... HISTOGRAM

HISTOGRAM ...

  ARG=tic2
  GRID_MIN=-3
  GRID_MAX=2.0
  GRID_BIN=200
  BANDWIDTH=0.03
  LOGWEIGHTS=weights1
  LABEL=hh3

... HISTOGRAM


HISTOGRAM ...

  ARG=tic3
  GRID_MIN=-2.0
  GRID_MAX=2.5
  GRID_BIN=200
  BANDWIDTH=0.03
  LOGWEIGHTS=weights1
  LABEL=hh4

... HISTOGRAM

HISTOGRAM ...

  ARG=tic4
  GRID_MIN=-4.5
  GRID_MAX=3.5
  GRID_BIN=200
  BANDWIDTH=0.03
  LOGWEIGHTS=weights1
  LABEL=hh5

... HISTOGRAM

HISTOGRAM ...

  ARG=chi1,chi2
  GRID_MIN=-pi,-pi
  GRID_MAX=pi,pi
  GRID_BIN=200,200
  BANDWIDTH=0.03,0.03
  LOGWEIGHTS=weights1
  LABEL=hh6

... HISTOGRAM

HISTOGRAM ...

  ARG=chi1
  GRID_MIN=-pi
  GRID_MAX=pi
  GRID_BIN=200
  BANDWIDTH=0.03
  LOGWEIGHTS=weights1
  LABEL=hh7

... HISTOGRAM


HISTOGRAM ...

  ARG=chi2
  GRID_MIN=-pi
  GRID_MAX=pi
  GRID_BIN=200
  BANDWIDTH=0.03
  LOGWEIGHTS=weights1
  LABEL=hh8

... HISTOGRAM


HISTOGRAM ...

  ARG=chi1,d1
  GRID_MIN=-pi,0.7
  GRID_MAX=pi,2.8
  GRID_BIN=200,200
  BANDWIDTH=0.03,0.02
  LOGWEIGHTS=weights1
  LABEL=hh9

... HISTOGRAM


HISTOGRAM ...

  ARG=chi1,d3
  GRID_MIN=-pi,0.2
  GRID_MAX=pi,2.6
  GRID_BIN=200,200
  BANDWIDTH=0.03,0.02
  LOGWEIGHTS=weights1
  LABEL=hh10

... HISTOGRAM

HISTOGRAM ...

  ARG=chi1,d4
  GRID_MIN=-pi,0.2
  GRID_MAX=pi,2.6
  GRID_BIN=200,200
  BANDWIDTH=0.03,0.02
  LOGWEIGHTS=weights1
  LABEL=hh11

... HISTOGRAM


HISTOGRAM ...

  ARG=t3,t4
  GRID_MIN=-pi,-pi
  GRID_MAX=pi,pi
  GRID_BIN=200,200
  BANDWIDTH=0.03,0.03
  LOGWEIGHTS=weights1
  LABEL=hh12

... HISTOGRAM


HISTOGRAM ...

  ARG=t3
  GRID_MIN=-pi
  GRID_MAX=pi
  GRID_BIN=200
  BANDWIDTH=0.03
  LOGWEIGHTS=weights1
  LABEL=hh13

... HISTOGRAM

HISTOGRAM ...

  ARG=t4
  GRID_MIN=-pi
  GRID_MAX=pi
  GRID_BIN=200
  BANDWIDTH=0.03
  LOGWEIGHTS=weights1
  LABEL=hh14

... HISTOGRAM

# Print histograms to file
#ff1: CONVERT_TO_FES GRID=hh1 TEMP=300 MINTOZERO
#DUMPGRID GRID=ff1 FILE=fes_tic0.dat
#DUMPGRID GRID=hh1 FILE=histo_tic0 FMT=%24.16e

#ff3: CONVERT_TO_FES GRID=hh3 TEMP=300 MINTOZERO
#DUMPGRID GRID=ff3 FILE=fes_tic2.dat 
#DUMPGRID GRID=hh3 FILE=histo_tic2 FMT=%24.16e

#ff2: CONVERT_TO_FES GRID=hh2 TEMP=300 MINTOZERO
#DUMPGRID GRID=ff2 FILE=fes_tic1.dat 
#DUMPGRID GRID=hh2 FILE=histo_tic1 FMT=%24.16e

#ff4: CONVERT_TO_FES GRID=hh4 TEMP=300 MINTOZERO
#DUMPGRID GRID=ff4 FILE=fes_tic3.dat
#DUMPGRID GRID=hh4 FILE=histo_tic3 FMT=%24.16e

#ff5: CONVERT_TO_FES GRID=hh5 TEMP=300 MINTOZERO
#DUMPGRID GRID=ff5 FILE=fes_tic4.dat
#DUMPGRID GRID=hh5 FILE=histo_tic4 FMT=%24.16e

ff6: CONVERT_TO_FES GRID=hh6 TEMP=300 MINTOZERO
DUMPGRID GRID=ff6 FILE=fes_chi1chi2.dat
DUMPGRID GRID=hh6 FILE=histo_chi1chi2 FMT=%24.16e

ff7: CONVERT_TO_FES GRID=hh7 TEMP=300 MINTOZERO
DUMPGRID GRID=ff7 FILE=fes_chi1.dat
DUMPGRID GRID=hh7 FILE=histo_chi1 FMT=%24.16e

ff8: CONVERT_TO_FES GRID=hh8 TEMP=300 MINTOZERO
DUMPGRID GRID=ff8 FILE=fes_chi2.dat
DUMPGRID GRID=hh8 FILE=histo_chi2 FMT=%24.16e

ff9: CONVERT_TO_FES GRID=hh9 TEMP=300 MINTOZERO
DUMPGRID GRID=ff9 FILE=fes_chi1_open.dat
DUMPGRID GRID=hh9 FILE=histo_chi1_open FMT=%24.16e

ff10: CONVERT_TO_FES GRID=hh10 TEMP=300 MINTOZERO
DUMPGRID GRID=ff10 FILE=fes_chi1_trp.dat
DUMPGRID GRID=hh10 FILE=histo_chi1_trp FMT=%24.16e

ff11: CONVERT_TO_FES GRID=hh11 TEMP=300 MINTOZERO
DUMPGRID GRID=ff11 FILE=fes_chi1_asp.dat
DUMPGRID GRID=hh11 FILE=histo_chi1_asp FMT=%24.16e

ff12: CONVERT_TO_FES GRID=hh12 TEMP=300 MINTOZERO
DUMPGRID GRID=ff12 FILE=fes_trpchi1chi2.dat
DUMPGRID GRID=hh12 FILE=histo_trpchi1chi2 FMT=%24.16e

ff13: CONVERT_TO_FES GRID=hh13 TEMP=300 MINTOZERO
DUMPGRID GRID=ff13 FILE=fes_trp1dchi1.dat
DUMPGRID GRID=hh13 FILE=histo_trp1dchi1 FMT=%24.16e

ff14: CONVERT_TO_FES GRID=hh14 TEMP=300 MINTOZERO
DUMPGRID GRID=ff14 FILE=fes_trp1dchi2.dat
DUMPGRID GRID=hh14 FILE=histo_trp1dchi2 FMT=%24.16e
